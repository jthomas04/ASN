<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ASND: /home/jj/Projects/ASN/vendors/tinymce/plugins/jbimages/ci/system/core/Input.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASND
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Documenting ASN for faster code Analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_input_8php_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Input.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_input_8php.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;?php  <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;BASEPATH&#39;</span>))</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    <a class="code" href="register_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a>(<span class="stringliteral">&#39;No direct script access allowed&#39;</span>);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// ------------------------------------------------------------------------</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="class_c_i___input.html">   30</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_i___input.html">CI_Input</a> {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a614e10d1ab6dcf06fa7fef37af7b7eee">   37</a></span>&#160;    var <a class="code" href="class_c_i___input.html#a614e10d1ab6dcf06fa7fef37af7b7eee">$ip_address</a> = FALSE;</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="class_c_i___input.html#aeea73d2dc27fea041fbcadae59f07cd5">   43</a></span>&#160;    var <a class="code" href="class_c_i___input.html#aeea73d2dc27fea041fbcadae59f07cd5">$user_agent</a> = FALSE;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a359b1debb6f1d80e345d6215af6946fb">   49</a></span>&#160;    var <a class="code" href="class_c_i___input.html#a359b1debb6f1d80e345d6215af6946fb">$_allow_get_array</a> = TRUE;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="class_c_i___input.html#ad9ebdfce8f992b3a41aaf64ea8782933">   55</a></span>&#160;    var <a class="code" href="class_c_i___input.html#ad9ebdfce8f992b3a41aaf64ea8782933">$_standardize_newlines</a> = TRUE;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a42b707bea5d9604a7460e953d9e39d7d">   62</a></span>&#160;    var <a class="code" href="class_c_i___input.html#a42b707bea5d9604a7460e953d9e39d7d">$_enable_xss</a> = FALSE;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a463c89c07e7cf7f5e4337a2a8e460d17">   69</a></span>&#160;    var <a class="code" href="class_c_i___input.html#a463c89c07e7cf7f5e4337a2a8e460d17">$_enable_csrf</a> = FALSE;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a52500036ee807241b8b4b7e2367c49ef">   75</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="class_c_i___input.html#a52500036ee807241b8b4b7e2367c49ef">$headers</a> = array();</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a095c5d389db211932136b53f25f39685">   85</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a095c5d389db211932136b53f25f39685">__construct</a>() {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        log_message(<span class="stringliteral">&#39;debug&#39;</span>, <span class="stringliteral">&quot;Input Class Initialized&quot;</span>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        $this-&gt;_allow_get_array = (config_item(<span class="stringliteral">&#39;allow_get_array&#39;</span>) === TRUE);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        $this-&gt;_enable_xss = (config_item(<span class="stringliteral">&#39;global_xss_filtering&#39;</span>) === TRUE);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        $this-&gt;_enable_csrf = (config_item(<span class="stringliteral">&#39;csrf_protection&#39;</span>) === TRUE);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        global <a class="code" href="_code_igniter_8php.html#ad1366cae5e96fdde83a2fd6053334acd">$SEC</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        $this-&gt;security =&amp; <a class="code" href="_code_igniter_8php.html#ad1366cae5e96fdde83a2fd6053334acd">$SEC</a>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="comment">// Do we need the UTF-8 class?</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span> (UTF8_ENABLED === TRUE) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            global <a class="code" href="_code_igniter_8php.html#a0eedd12db0d3774c174f0dba59577357">$UNI</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            $this-&gt;uni =&amp; <a class="code" href="_code_igniter_8php.html#a0eedd12db0d3774c174f0dba59577357">$UNI</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">// Sanitize global arrays</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        $this-&gt;<a class="code" href="class_c_i___input.html#aadbb0e5cbf9b5783c872cb402ea6a2fa">_sanitize_globals</a>();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="class_c_i___input.html#aadbb0e5cbf9b5783c872cb402ea6a2fa">  121</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#aadbb0e5cbf9b5783c872cb402ea6a2fa">_sanitize_globals</a>() {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">// It would be &quot;wrong&quot; to unset any of these GLOBALS.</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        $protected = array(</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="stringliteral">&#39;_SERVER&#39;</span>,</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="stringliteral">&#39;_GET&#39;</span>,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="stringliteral">&#39;_POST&#39;</span>,</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="stringliteral">&#39;_FILES&#39;</span>,</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="stringliteral">&#39;_REQUEST&#39;</span>,</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="stringliteral">&#39;_SESSION&#39;</span>,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="stringliteral">&#39;_ENV&#39;</span>,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="stringliteral">&#39;GLOBALS&#39;</span>,</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="stringliteral">&#39;HTTP_RAW_POST_DATA&#39;</span>,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="stringliteral">&#39;system_folder&#39;</span>,</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="stringliteral">&#39;application_folder&#39;</span>,</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="stringliteral">&#39;BM&#39;</span>,</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="stringliteral">&#39;EXT&#39;</span>,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="stringliteral">&#39;CFG&#39;</span>,</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="stringliteral">&#39;URI&#39;</span>,</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="stringliteral">&#39;RTR&#39;</span>,</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="stringliteral">&#39;OUT&#39;</span>,</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="stringliteral">&#39;IN&#39;</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        );</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">// Unset globals for securiy.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">// This is effectively the same as register_globals = off</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">foreach</span> (array(</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                     $_GET,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                     $_POST,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                     $_COOKIE</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                 ) as $global) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordflow">if</span> (!is_array($global)) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <span class="keywordflow">if</span> (!in_array($global, $protected)) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    global $$global;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    $$global = NULL;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keywordflow">foreach</span> ($global as $key =&gt; $val) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    <span class="keywordflow">if</span> (!in_array($key, $protected)) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                        global $$key;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        $$key = NULL;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// Is $_GET data allowed? If not we&#39;ll set the $_GET to an empty array</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;_allow_get_array == FALSE) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            $_GET = array();</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span> (is_array($_GET) AND <a class="code" href="photos_2pages_2photos_8php.html#a364678aa3bd05301b3d1b8650653cf48">count</a>($_GET) &gt; 0) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="keywordflow">foreach</span> ($_GET as $key =&gt; $val) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    $_GET[$this-&gt;<a class="code" href="class_c_i___input.html#af42e370cfe61ee5a34b72cf37b919210">_clean_input_keys</a>($key)] = $this-&gt;<a class="code" href="class_c_i___input.html#a9c594152e7b189a290f6425df8712b73">_clean_input_data</a>($val);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">// Clean $_POST Data</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span> (is_array($_POST) AND <a class="code" href="photos_2pages_2photos_8php.html#a364678aa3bd05301b3d1b8650653cf48">count</a>($_POST) &gt; 0) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordflow">foreach</span> ($_POST as $key =&gt; $val) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                $_POST[$this-&gt;<a class="code" href="class_c_i___input.html#af42e370cfe61ee5a34b72cf37b919210">_clean_input_keys</a>($key)] = $this-&gt;<a class="code" href="class_c_i___input.html#a9c594152e7b189a290f6425df8712b73">_clean_input_data</a>($val);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// Clean $_COOKIE Data</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">if</span> (is_array($_COOKIE) AND <a class="code" href="photos_2pages_2photos_8php.html#a364678aa3bd05301b3d1b8650653cf48">count</a>($_COOKIE) &gt; 0) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="comment">// Also get rid of specially treated cookies that might be set by a server</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="comment">// or silly application, that are of no use to a CI application anyway</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="comment">// but that when present will trip our &#39;Disallowed Key Characters&#39; alarm</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="comment">// http://www.ietf.org/rfc/rfc2109.txt</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="comment">// note that the key names below are single quoted strings, and are not PHP variables</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            unset($_COOKIE[<span class="stringliteral">&#39;$Version&#39;</span>]);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            unset($_COOKIE[<span class="stringliteral">&#39;$Path&#39;</span>]);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            unset($_COOKIE[<span class="stringliteral">&#39;$Domain&#39;</span>]);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">foreach</span> ($_COOKIE as $key =&gt; $val) {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                $_COOKIE[$this-&gt;<a class="code" href="class_c_i___input.html#af42e370cfe61ee5a34b72cf37b919210">_clean_input_keys</a>($key)] = $this-&gt;<a class="code" href="class_c_i___input.html#a9c594152e7b189a290f6425df8712b73">_clean_input_data</a>($val);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">// Sanitize PHP_SELF</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        $_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>] = strip_tags($_SERVER[<span class="stringliteral">&#39;PHP_SELF&#39;</span>]);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">// CSRF Protection check on HTTP requests</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;_enable_csrf == TRUE &amp;&amp; !$this-&gt;<a class="code" href="class_c_i___input.html#a70c1e8a081ef955c1a52164634d4f66e">is_cli_request</a>()) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            $this-&gt;security-&gt;csrf_verify();</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        log_message(<span class="stringliteral">&#39;debug&#39;</span>, <span class="stringliteral">&quot;Global POST and COOKIE data sanitized&quot;</span>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="class_c_i___input.html#af42e370cfe61ee5a34b72cf37b919210">  225</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#af42e370cfe61ee5a34b72cf37b919210">_clean_input_keys</a>($str) {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&quot;/^[a-z0-9:_\/-]+$/i&quot;</span>, $str)) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <a class="code" href="register_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a>(<span class="stringliteral">&#39;Disallowed Key Characters.&#39;</span>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">// Clean UTF-8 if supported</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span> (UTF8_ENABLED === TRUE) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            $str = $this-&gt;uni-&gt;clean_string($str);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">return</span> $str;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a9c594152e7b189a290f6425df8712b73">  250</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a9c594152e7b189a290f6425df8712b73">_clean_input_data</a>($str) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span> (is_array($str)) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            $new_array = array();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">foreach</span> ($str as $key =&gt; $val) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                $new_array[$this-&gt;<a class="code" href="class_c_i___input.html#af42e370cfe61ee5a34b72cf37b919210">_clean_input_keys</a>($key)] = $this-&gt;<a class="code" href="class_c_i___input.html#a9c594152e7b189a290f6425df8712b73">_clean_input_data</a>($val);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">return</span> $new_array;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">/* We strip slashes if magic quotes is on to keep things consistent</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">           NOTE: In PHP 5.4 get_magic_quotes_gpc() will always return 0 and</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">             it will probably not exist in future versions at all.</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">if</span> (!is_php(<span class="stringliteral">&#39;5.4&#39;</span>) &amp;&amp; get_magic_quotes_gpc()) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            $str = stripslashes($str);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">// Clean UTF-8 if supported</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> (UTF8_ENABLED === TRUE) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            $str = $this-&gt;uni-&gt;clean_string($str);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// Remove control characters</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        $str = remove_invisible_characters($str);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">// Should we filter the input data?</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;_enable_xss === TRUE) {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            $str = $this-&gt;security-&gt;xss_clean($str);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">// Standardize newlines if needed</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;_standardize_newlines == TRUE) {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">if</span> (strpos($str, <span class="stringliteral">&quot;\r&quot;</span>) !== FALSE) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                $str = str_replace(array(</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        <span class="stringliteral">&quot;\r&quot;</span>,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <span class="stringliteral">&quot;\r\n\n&quot;</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    ), PHP_EOL, $str);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">return</span> $str;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a70c1e8a081ef955c1a52164634d4f66e">  305</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a70c1e8a081ef955c1a52164634d4f66e">is_cli_request</a>() {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">return</span> (php_sapi_name() === <span class="stringliteral">&#39;cli&#39;</span> OR defined(<span class="stringliteral">&#39;STDIN&#39;</span>));</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="class_c_i___input.html#aec54f245bc5c3215ba81a594ed858b2f">  319</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#aec54f245bc5c3215ba81a594ed858b2f">get_post</a>($index = <span class="stringliteral">&#39;&#39;</span>, $xss_clean = FALSE) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">if</span> (!isset($_POST[$index])) {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">return</span> $this-&gt;<span class="keyword">get</span>($index, $xss_clean);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_i___input.html#a50ac0e340a9da4d85cc976e78d99a7c0">post</a>($index, $xss_clean);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// ------------------------------------------------------------------------</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a7f3fe35f15454cbad4f12fd8a0e195e1">  338</a></span>&#160;    <span class="keyword">function</span> <span class="keyword">get</span>($index = NULL, $xss_clean = FALSE) {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="comment">// Check if a field has been provided</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span> ($index === NULL AND !empty($_GET)) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <a class="code" href="_ossn_notifications_2plugins_2default_2notifications_2pages_2all_8php.html#a6dba07cf5cb37f05ef89d2b9afacf046">$get</a> = array();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="comment">// loop through the full _GET array</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">foreach</span> (array_keys($_GET) as $key) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <a class="code" href="_ossn_notifications_2plugins_2default_2notifications_2pages_2all_8php.html#a6dba07cf5cb37f05ef89d2b9afacf046">$get</a>[$key] = $this-&gt;<a class="code" href="class_c_i___input.html#a206046338a68072d20b5bde395c42cd7">_fetch_from_array</a>($_GET, $key, $xss_clean);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="_ossn_notifications_2plugins_2default_2notifications_2pages_2all_8php.html#a6dba07cf5cb37f05ef89d2b9afacf046">$get</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_i___input.html#a206046338a68072d20b5bde395c42cd7">_fetch_from_array</a>($_GET, $index, $xss_clean);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a206046338a68072d20b5bde395c42cd7">  366</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a206046338a68072d20b5bde395c42cd7">_fetch_from_array</a>(&amp;$array, $index = <span class="stringliteral">&#39;&#39;</span>, $xss_clean = FALSE) {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">if</span> (!isset($array[$index])) {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">return</span> FALSE;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">if</span> ($xss_clean === TRUE) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="keywordflow">return</span> $this-&gt;security-&gt;xss_clean($array[$index]);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">return</span> $array[$index];</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a50ac0e340a9da4d85cc976e78d99a7c0">  389</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a50ac0e340a9da4d85cc976e78d99a7c0">post</a>($index = NULL, $xss_clean = FALSE) {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">// Check if a field has been provided</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">if</span> ($index === NULL AND !empty($_POST)) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <a class="code" href="actions_2post_2comment_8php.html#a4fb32f285a9d3229aeaca99a18372945">$post</a> = array();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="comment">// Loop through the full _POST array and return it</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">foreach</span> (array_keys($_POST) as $key) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <a class="code" href="actions_2post_2comment_8php.html#a4fb32f285a9d3229aeaca99a18372945">$post</a>[$key] = $this-&gt;<a class="code" href="class_c_i___input.html#a206046338a68072d20b5bde395c42cd7">_fetch_from_array</a>($_POST, $key, $xss_clean);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="actions_2post_2comment_8php.html#a4fb32f285a9d3229aeaca99a18372945">$post</a>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_i___input.html#a206046338a68072d20b5bde395c42cd7">_fetch_from_array</a>($_POST, $index, $xss_clean);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a60e581edbf6507bf0702fd5212ac79a4">  414</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a60e581edbf6507bf0702fd5212ac79a4">cookie</a>($index = <span class="stringliteral">&#39;&#39;</span>, $xss_clean = FALSE) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_i___input.html#a206046338a68072d20b5bde395c42cd7">_fetch_from_array</a>($_COOKIE, $index, $xss_clean);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="class_c_i___input.html#aae6a307dce00b4d06a29c6f0be9e4b59">  436</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#aae6a307dce00b4d06a29c6f0be9e4b59">set_cookie</a>(<a class="code" href="components_2_ossn_groups_2actions_2group_2edit_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="dropdown_8php.html#a5bd63f8afd4dd4ba86dcdf5618904298">$value</a> = <span class="stringliteral">&#39;&#39;</span>, $expire = <span class="stringliteral">&#39;&#39;</span>, $domain = <span class="stringliteral">&#39;&#39;</span>, $path = <span class="charliteral">&#39;/&#39;</span>, $prefix = <span class="stringliteral">&#39;&#39;</span>, $secure = FALSE) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">if</span> (is_array(<a class="code" href="components_2_ossn_groups_2actions_2group_2edit_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>)) {</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="comment">// always leave &#39;name&#39; in last place, as the loop will break otherwise, due to $$item</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">foreach</span> (array(</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                         <span class="stringliteral">&#39;value&#39;</span>,</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                         <span class="stringliteral">&#39;expire&#39;</span>,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                         <span class="stringliteral">&#39;domain&#39;</span>,</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                         <span class="stringliteral">&#39;path&#39;</span>,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                         <span class="stringliteral">&#39;prefix&#39;</span>,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                         <span class="stringliteral">&#39;secure&#39;</span>,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                         <span class="stringliteral">&#39;name&#39;</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                     ) as $item) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="keywordflow">if</span> (isset(<a class="code" href="components_2_ossn_groups_2actions_2group_2edit_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>[$item])) {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    $$item = <a class="code" href="components_2_ossn_groups_2actions_2group_2edit_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>[$item];</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> ($prefix == <span class="stringliteral">&#39;&#39;</span> AND config_item(<span class="stringliteral">&#39;cookie_prefix&#39;</span>) != <span class="stringliteral">&#39;&#39;</span>) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            $prefix = config_item(<span class="stringliteral">&#39;cookie_prefix&#39;</span>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordflow">if</span> ($domain == <span class="stringliteral">&#39;&#39;</span> AND config_item(<span class="stringliteral">&#39;cookie_domain&#39;</span>) != <span class="stringliteral">&#39;&#39;</span>) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            $domain = config_item(<span class="stringliteral">&#39;cookie_domain&#39;</span>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">if</span> ($path == <span class="charliteral">&#39;/&#39;</span> AND config_item(<span class="stringliteral">&#39;cookie_path&#39;</span>) != <span class="charliteral">&#39;/&#39;</span>) {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            $path = config_item(<span class="stringliteral">&#39;cookie_path&#39;</span>);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">if</span> ($secure == FALSE AND config_item(<span class="stringliteral">&#39;cookie_secure&#39;</span>) != FALSE) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            $secure = config_item(<span class="stringliteral">&#39;cookie_secure&#39;</span>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">if</span> (!is_numeric($expire)) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            $expire = time() - 86500;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            $expire = ($expire &gt; 0) ? time() + $expire : 0;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        setcookie($prefix . <a class="code" href="components_2_ossn_groups_2actions_2group_2edit_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="dropdown_8php.html#a5bd63f8afd4dd4ba86dcdf5618904298">$value</a>, $expire, $path, $domain, $secure);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="class_c_i___input.html#aec2f772317b4fb79cc696412c2e455c3">  483</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#aec2f772317b4fb79cc696412c2e455c3">ip_address</a>() {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_c_i___input.html#aec2f772317b4fb79cc696412c2e455c3">ip_address</a> !== FALSE) {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_c_i___input.html#a614e10d1ab6dcf06fa7fef37af7b7eee">$this-&gt;ip_address</a>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        $proxy_ips = config_item(<span class="stringliteral">&#39;proxy_ips&#39;</span>);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">if</span> (!empty($proxy_ips)) {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            $proxy_ips = explode(<span class="charliteral">&#39;,&#39;</span>, str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $proxy_ips));</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="keywordflow">foreach</span> (array(</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                         <span class="stringliteral">&#39;HTTP_X_FORWARDED_FOR&#39;</span>,</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                         <span class="stringliteral">&#39;HTTP_CLIENT_IP&#39;</span>,</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                         <span class="stringliteral">&#39;HTTP_X_CLIENT_IP&#39;</span>,</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                         <span class="stringliteral">&#39;HTTP_X_CLUSTER_CLIENT_IP&#39;</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                     ) as $header) {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="keywordflow">if</span> (($spoof = $this-&gt;<a class="code" href="class_c_i___input.html#ae51c4a35daae69cbec7a25a5309918d9">server</a>($header)) !== FALSE) {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    <span class="comment">// Some proxies typically list the whole chain of IP</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    <span class="comment">// addresses through which the client has reached us.</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                    <span class="comment">// e.g. client_ip, proxy_ip1, proxy_ip2, etc.</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    <span class="keywordflow">if</span> (strpos($spoof, <span class="charliteral">&#39;,&#39;</span>) !== FALSE) {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                        $spoof = explode(<span class="charliteral">&#39;,&#39;</span>, $spoof, 2);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                        $spoof = $spoof[0];</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="class_c_i___input.html#a2adf8f23c98fcdafdc7588f874db4c4d">valid_ip</a>($spoof)) {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        $spoof = FALSE;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            $this-&gt;<a class="code" href="class_c_i___input.html#aec2f772317b4fb79cc696412c2e455c3">ip_address</a> = ($spoof !== FALSE &amp;&amp; in_array($_SERVER[<span class="stringliteral">&#39;REMOTE_ADDR&#39;</span>], $proxy_ips, TRUE)) ? $spoof : $_SERVER[<span class="stringliteral">&#39;REMOTE_ADDR&#39;</span>];</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            $this-&gt;<a class="code" href="class_c_i___input.html#aec2f772317b4fb79cc696412c2e455c3">ip_address</a> = $_SERVER[<span class="stringliteral">&#39;REMOTE_ADDR&#39;</span>];</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="class_c_i___input.html#a2adf8f23c98fcdafdc7588f874db4c4d">valid_ip</a>($this-&gt;<a class="code" href="class_c_i___input.html#aec2f772317b4fb79cc696412c2e455c3">ip_address</a>)) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            $this-&gt;<a class="code" href="class_c_i___input.html#aec2f772317b4fb79cc696412c2e455c3">ip_address</a> = <span class="stringliteral">&#39;0.0.0.0&#39;</span>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_c_i___input.html#a614e10d1ab6dcf06fa7fef37af7b7eee">$this-&gt;ip_address</a>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="class_c_i___input.html#ae51c4a35daae69cbec7a25a5309918d9">  536</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#ae51c4a35daae69cbec7a25a5309918d9">server</a>($index = <span class="stringliteral">&#39;&#39;</span>, $xss_clean = FALSE) {</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_c_i___input.html#a206046338a68072d20b5bde395c42cd7">_fetch_from_array</a>($_SERVER, $index, $xss_clean);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a2adf8f23c98fcdafdc7588f874db4c4d">  550</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a2adf8f23c98fcdafdc7588f874db4c4d">valid_ip</a>($ip, $which = <span class="stringliteral">&#39;&#39;</span>) {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        $which = strtolower($which);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="comment">// First check if filter_var is available</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keywordflow">if</span> (is_callable(<span class="stringliteral">&#39;filter_var&#39;</span>)) {</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="keywordflow">switch</span> ($which) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;ipv4&#39;</span>:</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                    $flag = FILTER_FLAG_IPV4;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;ipv6&#39;</span>:</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                    $flag = FILTER_FLAG_IPV6;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                <span class="keywordflow">default</span>:</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                    $flag = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="keywordflow">return</span> (<span class="keywordtype">bool</span>)filter_var($ip, FILTER_VALIDATE_IP, $flag);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">if</span> ($which !== <span class="stringliteral">&#39;ipv6&#39;</span> &amp;&amp; $which !== <span class="stringliteral">&#39;ipv4&#39;</span>) {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordflow">if</span> (strpos($ip, <span class="charliteral">&#39;:&#39;</span>) !== FALSE) {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                $which = <span class="stringliteral">&#39;ipv6&#39;</span>;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            } <a class="code" href="components_2_ossn_groups_2plugins_2default_2forms_2_ossn_groups_2edit_8php.html#a193e3a573c5e50b6f6604ac849466645">elseif</a> (strpos($ip, <span class="charliteral">&#39;.&#39;</span>) !== FALSE) {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                $which = <span class="stringliteral">&#39;ipv4&#39;</span>;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                <span class="keywordflow">return</span> FALSE;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        $func = <span class="stringliteral">&#39;_valid_&#39;</span> . $which;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">return</span> $this-&gt;$func($ip);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a638069c4ba0d3f4209c6936e5282f170">  592</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a638069c4ba0d3f4209c6936e5282f170">user_agent</a>() {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_c_i___input.html#a638069c4ba0d3f4209c6936e5282f170">user_agent</a> !== FALSE) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_c_i___input.html#aeea73d2dc27fea041fbcadae59f07cd5">$this-&gt;user_agent</a>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        $this-&gt;<a class="code" href="class_c_i___input.html#a638069c4ba0d3f4209c6936e5282f170">user_agent</a> = (!isset($_SERVER[<span class="stringliteral">&#39;HTTP_USER_AGENT&#39;</span>])) ? FALSE : $_SERVER[<span class="stringliteral">&#39;HTTP_USER_AGENT&#39;</span>];</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_c_i___input.html#aeea73d2dc27fea041fbcadae59f07cd5">$this-&gt;user_agent</a>;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a099af71b54f9edbfb20576a4e8a3df41">  613</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a099af71b54f9edbfb20576a4e8a3df41">get_request_header</a>($index, $xss_clean = FALSE) {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span> (empty($this-&gt;headers)) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            $this-&gt;<a class="code" href="class_c_i___input.html#a4bc8f8c9a9488ff359a61f1fb60e6097">request_headers</a>();</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;headers[$index])) {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">return</span> FALSE;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">if</span> ($xss_clean === TRUE) {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="keywordflow">return</span> $this-&gt;security-&gt;xss_clean($this-&gt;headers[$index]);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">return</span> $this-&gt;headers[$index];</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a4bc8f8c9a9488ff359a61f1fb60e6097">  641</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a4bc8f8c9a9488ff359a61f1fb60e6097">request_headers</a>($xss_clean = FALSE) {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="comment">// Look at Apache go!</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;apache_request_headers&#39;</span>)) {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <a class="code" href="class_c_i___input.html#a52500036ee807241b8b4b7e2367c49ef">$headers</a> = apache_request_headers();</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <a class="code" href="class_c_i___input.html#a52500036ee807241b8b4b7e2367c49ef">$headers</a>[<span class="stringliteral">&#39;Content-Type&#39;</span>] = (isset($_SERVER[<span class="stringliteral">&#39;CONTENT_TYPE&#39;</span>])) ? $_SERVER[<span class="stringliteral">&#39;CONTENT_TYPE&#39;</span>] : @getenv(<span class="stringliteral">&#39;CONTENT_TYPE&#39;</span>);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keywordflow">foreach</span> ($_SERVER as $key =&gt; $val) {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                <span class="keywordflow">if</span> (strncmp($key, <span class="stringliteral">&#39;HTTP_&#39;</span>, 5) === 0) {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    <a class="code" href="class_c_i___input.html#a52500036ee807241b8b4b7e2367c49ef">$headers</a>[substr($key, 5)] = $this-&gt;<a class="code" href="class_c_i___input.html#a206046338a68072d20b5bde395c42cd7">_fetch_from_array</a>($_SERVER, $key, $xss_clean);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="comment">// take SOME_HEADER and turn it into Some-Header</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">foreach</span> (<a class="code" href="class_c_i___input.html#a52500036ee807241b8b4b7e2367c49ef">$headers</a> as $key =&gt; $val) {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            $key = str_replace(<span class="charliteral">&#39;_&#39;</span>, <span class="charliteral">&#39; &#39;</span>, strtolower($key));</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            $key = str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="charliteral">&#39;-&#39;</span>, ucwords($key));</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            $this-&gt;headers[$key] = $val;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_c_i___input.html#a52500036ee807241b8b4b7e2367c49ef">$this-&gt;headers</a>;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a4ae07120b0b2ace90eb2f7ec72b29426">  675</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a4ae07120b0b2ace90eb2f7ec72b29426">is_ajax_request</a>() {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">return</span> ($this-&gt;<a class="code" href="class_c_i___input.html#ae51c4a35daae69cbec7a25a5309918d9">server</a>(<span class="stringliteral">&#39;HTTP_X_REQUESTED_WITH&#39;</span>) === <span class="stringliteral">&#39;XMLHttpRequest&#39;</span>);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno"><a class="line" href="class_c_i___input.html#a25d7802ebfe7e908ea45310013a24723">  688</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#a25d7802ebfe7e908ea45310013a24723">_valid_ipv6</a>($str) {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="comment">// 8 groups, separated by :</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="comment">// 0-ffff per group</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="comment">// one set of consecutive 0 groups can be collapsed to ::</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        $groups = 8;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        $collapsed = FALSE;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        $chunks = array_filter(preg_split(<span class="stringliteral">&#39;/(:{1,2})/&#39;</span>, $str, NULL, PREG_SPLIT_DELIM_CAPTURE));</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="comment">// Rule out easy nonsense</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keywordflow">if</span> (current($chunks) == <span class="charliteral">&#39;:&#39;</span> OR end($chunks) == <span class="charliteral">&#39;:&#39;</span>) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="keywordflow">return</span> FALSE;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="comment">// PHP supports IPv4-mapped IPv6 addresses, so we&#39;ll expect those as well</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">if</span> (strpos(end($chunks), <span class="charliteral">&#39;.&#39;</span>) !== FALSE) {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            $ipv4 = array_pop($chunks);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="class_c_i___input.html#acc1814d63877524ba3434eca5453edf0">_valid_ipv4</a>($ipv4)) {</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                <span class="keywordflow">return</span> FALSE;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            $groups--;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordflow">while</span> ($seg = array_pop($chunks)) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keywordflow">if</span> ($seg[0] == <span class="charliteral">&#39;:&#39;</span>) {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                <span class="keywordflow">if</span> (--$groups == 0) {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <span class="keywordflow">return</span> FALSE;    <span class="comment">// too many groups</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                <span class="keywordflow">if</span> (strlen($seg) &gt; 2) {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    <span class="keywordflow">return</span> FALSE;    <span class="comment">// long separator</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                <span class="keywordflow">if</span> ($seg == <span class="stringliteral">&#39;::&#39;</span>) {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    <span class="keywordflow">if</span> ($collapsed) {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                        <span class="keywordflow">return</span> FALSE;    <span class="comment">// multiple collapsed</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    }</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                    $collapsed = TRUE;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            } <a class="code" href="components_2_ossn_groups_2plugins_2default_2forms_2_ossn_groups_2edit_8php.html#a193e3a573c5e50b6f6604ac849466645">elseif</a> (preg_match(<span class="stringliteral">&quot;/[^0-9a-f]/i&quot;</span>, $seg) OR strlen($seg) &gt; 4) {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="keywordflow">return</span> FALSE; <span class="comment">// invalid segment</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        }</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordflow">return</span> $collapsed OR $groups == 1;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno"><a class="line" href="class_c_i___input.html#acc1814d63877524ba3434eca5453edf0">  750</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_c_i___input.html#acc1814d63877524ba3434eca5453edf0">_valid_ipv4</a>($ip) {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        $ip_segments = explode(<span class="charliteral">&#39;.&#39;</span>, $ip);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="comment">// Always 4 segments needed</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="photos_2pages_2photos_8php.html#a364678aa3bd05301b3d1b8650653cf48">count</a>($ip_segments) !== 4) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">return</span> FALSE;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="comment">// IP can not start with 0</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">if</span> ($ip_segments[0][0] == <span class="charliteral">&#39;0&#39;</span>) {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="keywordflow">return</span> FALSE;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="comment">// Check each segment</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">foreach</span> ($ip_segments as $segment) {</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="comment">// IP segments must be digits and can not be</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="comment">// longer than 3 digits or greater then 255</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordflow">if</span> ($segment == <span class="stringliteral">&#39;&#39;</span> OR preg_match(<span class="stringliteral">&quot;/[^0-9]/&quot;</span>, $segment) OR $segment &gt; 255 OR strlen($segment) &gt; 3) {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <span class="keywordflow">return</span> FALSE;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keywordflow">return</span> TRUE;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    }</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;}</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">/* End of file Input.php */</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">/* Location: ./system/core/Input.php */</span></div><div class="ttc" id="class_c_i___input_html_ae51c4a35daae69cbec7a25a5309918d9"><div class="ttname"><a href="class_c_i___input.html#ae51c4a35daae69cbec7a25a5309918d9">CI_Input\server</a></div><div class="ttdeci">server($index= '', $xss_clean=FALSE)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00536">Input.php:536</a></div></div>
<div class="ttc" id="class_c_i___input_html_aec2f772317b4fb79cc696412c2e455c3"><div class="ttname"><a href="class_c_i___input.html#aec2f772317b4fb79cc696412c2e455c3">CI_Input\ip_address</a></div><div class="ttdeci">ip_address()</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00483">Input.php:483</a></div></div>
<div class="ttc" id="class_c_i___input_html_a25d7802ebfe7e908ea45310013a24723"><div class="ttname"><a href="class_c_i___input.html#a25d7802ebfe7e908ea45310013a24723">CI_Input\_valid_ipv6</a></div><div class="ttdeci">_valid_ipv6($str)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00688">Input.php:688</a></div></div>
<div class="ttc" id="class_c_i___input_html_a70c1e8a081ef955c1a52164634d4f66e"><div class="ttname"><a href="class_c_i___input.html#a70c1e8a081ef955c1a52164634d4f66e">CI_Input\is_cli_request</a></div><div class="ttdeci">is_cli_request()</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00305">Input.php:305</a></div></div>
<div class="ttc" id="class_c_i___input_html_a4ae07120b0b2ace90eb2f7ec72b29426"><div class="ttname"><a href="class_c_i___input.html#a4ae07120b0b2ace90eb2f7ec72b29426">CI_Input\is_ajax_request</a></div><div class="ttdeci">is_ajax_request()</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00675">Input.php:675</a></div></div>
<div class="ttc" id="class_c_i___input_html_aadbb0e5cbf9b5783c872cb402ea6a2fa"><div class="ttname"><a href="class_c_i___input.html#aadbb0e5cbf9b5783c872cb402ea6a2fa">CI_Input\_sanitize_globals</a></div><div class="ttdeci">_sanitize_globals()</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00121">Input.php:121</a></div></div>
<div class="ttc" id="components_2_ossn_groups_2plugins_2default_2forms_2_ossn_groups_2edit_8php_html_a193e3a573c5e50b6f6604ac849466645"><div class="ttname"><a href="components_2_ossn_groups_2plugins_2default_2forms_2_ossn_groups_2edit_8php.html#a193e3a573c5e50b6f6604ac849466645">elseif</a></div><div class="ttdeci">if($group-&gt;membership==OSSN_PUBLIC) elseif($group-&gt;membership==OSSN_PRIVATE)</div><div class="ttdef"><b>Definition:</b> <a href="components_2_ossn_groups_2plugins_2default_2forms_2_ossn_groups_2edit_8php_source.html#l00018">edit.php:18</a></div></div>
<div class="ttc" id="class_c_i___input_html_a095c5d389db211932136b53f25f39685"><div class="ttname"><a href="class_c_i___input.html#a095c5d389db211932136b53f25f39685">CI_Input\__construct</a></div><div class="ttdeci">__construct()</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00085">Input.php:85</a></div></div>
<div class="ttc" id="class_c_i___input_html_a60e581edbf6507bf0702fd5212ac79a4"><div class="ttname"><a href="class_c_i___input.html#a60e581edbf6507bf0702fd5212ac79a4">CI_Input\cookie</a></div><div class="ttdeci">cookie($index= '', $xss_clean=FALSE)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00414">Input.php:414</a></div></div>
<div class="ttc" id="class_c_i___input_html_a9c594152e7b189a290f6425df8712b73"><div class="ttname"><a href="class_c_i___input.html#a9c594152e7b189a290f6425df8712b73">CI_Input\_clean_input_data</a></div><div class="ttdeci">_clean_input_data($str)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00250">Input.php:250</a></div></div>
<div class="ttc" id="class_c_i___input_html_acc1814d63877524ba3434eca5453edf0"><div class="ttname"><a href="class_c_i___input.html#acc1814d63877524ba3434eca5453edf0">CI_Input\_valid_ipv4</a></div><div class="ttdeci">_valid_ipv4($ip)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00750">Input.php:750</a></div></div>
<div class="ttc" id="_code_igniter_8php_html_a0eedd12db0d3774c174f0dba59577357"><div class="ttname"><a href="_code_igniter_8php.html#a0eedd12db0d3774c174f0dba59577357">$UNI</a></div><div class="ttdeci">if(isset($assign_to_config)) $UNI</div><div class="ttdef"><b>Definition:</b> <a href="_code_igniter_8php_source.html#l00152">CodeIgniter.php:152</a></div></div>
<div class="ttc" id="dropdown_8php_html_a5bd63f8afd4dd4ba86dcdf5618904298"><div class="ttname"><a href="dropdown_8php.html#a5bd63f8afd4dd4ba86dcdf5618904298">$value</a></div><div class="ttdeci">if(isset($params['class'])) $value</div><div class="ttdef"><b>Definition:</b> <a href="dropdown_8php_source.html#l00008">dropdown.php:8</a></div></div>
<div class="ttc" id="class_c_i___input_html_a42b707bea5d9604a7460e953d9e39d7d"><div class="ttname"><a href="class_c_i___input.html#a42b707bea5d9604a7460e953d9e39d7d">CI_Input\$_enable_xss</a></div><div class="ttdeci">$_enable_xss</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00062">Input.php:62</a></div></div>
<div class="ttc" id="class_c_i___input_html_a614e10d1ab6dcf06fa7fef37af7b7eee"><div class="ttname"><a href="class_c_i___input.html#a614e10d1ab6dcf06fa7fef37af7b7eee">CI_Input\$ip_address</a></div><div class="ttdeci">$ip_address</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00037">Input.php:37</a></div></div>
<div class="ttc" id="_ossn_notifications_2plugins_2default_2notifications_2pages_2all_8php_html_a6dba07cf5cb37f05ef89d2b9afacf046"><div class="ttname"><a href="_ossn_notifications_2plugins_2default_2notifications_2pages_2all_8php.html#a6dba07cf5cb37f05ef89d2b9afacf046">$get</a></div><div class="ttdeci">$get</div><div class="ttdef"><b>Definition:</b> <a href="_ossn_notifications_2plugins_2default_2notifications_2pages_2all_8php_source.html#l00004">all.php:4</a></div></div>
<div class="ttc" id="class_c_i___input_html_aae6a307dce00b4d06a29c6f0be9e4b59"><div class="ttname"><a href="class_c_i___input.html#aae6a307dce00b4d06a29c6f0be9e4b59">CI_Input\set_cookie</a></div><div class="ttdeci">set_cookie($name= '', $value= '', $expire= '', $domain= '', $path= '/', $prefix= '', $secure=FALSE)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00436">Input.php:436</a></div></div>
<div class="ttc" id="class_c_i___input_html_a4bc8f8c9a9488ff359a61f1fb60e6097"><div class="ttname"><a href="class_c_i___input.html#a4bc8f8c9a9488ff359a61f1fb60e6097">CI_Input\request_headers</a></div><div class="ttdeci">request_headers($xss_clean=FALSE)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00641">Input.php:641</a></div></div>
<div class="ttc" id="register_8php_html_a6733eb5f605d09eaede9845835d71c4e"><div class="ttname"><a href="register_8php.html#a6733eb5f605d09eaede9845835d71c4e">exit</a></div><div class="ttdeci">exit</div><div class="ttdef"><b>Definition:</b> <a href="register_8php_source.html#l00085">register.php:85</a></div></div>
<div class="ttc" id="class_c_i___input_html_a50ac0e340a9da4d85cc976e78d99a7c0"><div class="ttname"><a href="class_c_i___input.html#a50ac0e340a9da4d85cc976e78d99a7c0">CI_Input\post</a></div><div class="ttdeci">post($index=NULL, $xss_clean=FALSE)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00389">Input.php:389</a></div></div>
<div class="ttc" id="class_c_i___input_html_a359b1debb6f1d80e345d6215af6946fb"><div class="ttname"><a href="class_c_i___input.html#a359b1debb6f1d80e345d6215af6946fb">CI_Input\$_allow_get_array</a></div><div class="ttdeci">$_allow_get_array</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00049">Input.php:49</a></div></div>
<div class="ttc" id="class_c_i___input_html"><div class="ttname"><a href="class_c_i___input.html">CI_Input</a></div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00030">Input.php:30</a></div></div>
<div class="ttc" id="class_c_i___input_html_a2adf8f23c98fcdafdc7588f874db4c4d"><div class="ttname"><a href="class_c_i___input.html#a2adf8f23c98fcdafdc7588f874db4c4d">CI_Input\valid_ip</a></div><div class="ttdeci">valid_ip($ip, $which= '')</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00550">Input.php:550</a></div></div>
<div class="ttc" id="class_c_i___input_html_a638069c4ba0d3f4209c6936e5282f170"><div class="ttname"><a href="class_c_i___input.html#a638069c4ba0d3f4209c6936e5282f170">CI_Input\user_agent</a></div><div class="ttdeci">user_agent()</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00592">Input.php:592</a></div></div>
<div class="ttc" id="class_c_i___input_html_a206046338a68072d20b5bde395c42cd7"><div class="ttname"><a href="class_c_i___input.html#a206046338a68072d20b5bde395c42cd7">CI_Input\_fetch_from_array</a></div><div class="ttdeci">_fetch_from_array(&amp;$array, $index= '', $xss_clean=FALSE)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00366">Input.php:366</a></div></div>
<div class="ttc" id="class_c_i___input_html_af42e370cfe61ee5a34b72cf37b919210"><div class="ttname"><a href="class_c_i___input.html#af42e370cfe61ee5a34b72cf37b919210">CI_Input\_clean_input_keys</a></div><div class="ttdeci">_clean_input_keys($str)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00225">Input.php:225</a></div></div>
<div class="ttc" id="components_2_ossn_groups_2actions_2group_2edit_8php_html_ab2fc40d43824ea3e1ce5d86dee0d763b"><div class="ttname"><a href="components_2_ossn_groups_2actions_2group_2edit_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a></div><div class="ttdeci">$name</div><div class="ttdef"><b>Definition:</b> <a href="components_2_ossn_groups_2actions_2group_2edit_8php_source.html#l00004">edit.php:4</a></div></div>
<div class="ttc" id="photos_2pages_2photos_8php_html_a364678aa3bd05301b3d1b8650653cf48"><div class="ttname"><a href="photos_2pages_2photos_8php.html#a364678aa3bd05301b3d1b8650653cf48">count</a></div><div class="ttdeci">$albums count</div><div class="ttdef"><b>Definition:</b> <a href="photos_2pages_2photos_8php_source.html#l00009">photos.php:9</a></div></div>
<div class="ttc" id="class_c_i___input_html_a463c89c07e7cf7f5e4337a2a8e460d17"><div class="ttname"><a href="class_c_i___input.html#a463c89c07e7cf7f5e4337a2a8e460d17">CI_Input\$_enable_csrf</a></div><div class="ttdeci">$_enable_csrf</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00069">Input.php:69</a></div></div>
<div class="ttc" id="class_c_i___input_html_aec54f245bc5c3215ba81a594ed858b2f"><div class="ttname"><a href="class_c_i___input.html#aec54f245bc5c3215ba81a594ed858b2f">CI_Input\get_post</a></div><div class="ttdeci">get_post($index= '', $xss_clean=FALSE)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00319">Input.php:319</a></div></div>
<div class="ttc" id="class_c_i___input_html_a099af71b54f9edbfb20576a4e8a3df41"><div class="ttname"><a href="class_c_i___input.html#a099af71b54f9edbfb20576a4e8a3df41">CI_Input\get_request_header</a></div><div class="ttdeci">get_request_header($index, $xss_clean=FALSE)</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00613">Input.php:613</a></div></div>
<div class="ttc" id="class_c_i___input_html_aeea73d2dc27fea041fbcadae59f07cd5"><div class="ttname"><a href="class_c_i___input.html#aeea73d2dc27fea041fbcadae59f07cd5">CI_Input\$user_agent</a></div><div class="ttdeci">$user_agent</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00043">Input.php:43</a></div></div>
<div class="ttc" id="_code_igniter_8php_html_ad1366cae5e96fdde83a2fd6053334acd"><div class="ttname"><a href="_code_igniter_8php.html#ad1366cae5e96fdde83a2fd6053334acd">$SEC</a></div><div class="ttdeci">if($EXT-&gt;_call_hook('cache_override')===FALSE) $SEC</div><div class="ttdef"><b>Definition:</b> <a href="_code_igniter_8php_source.html#l00197">CodeIgniter.php:197</a></div></div>
<div class="ttc" id="actions_2post_2comment_8php_html_a4fb32f285a9d3229aeaca99a18372945"><div class="ttname"><a href="actions_2post_2comment_8php.html#a4fb32f285a9d3229aeaca99a18372945">$post</a></div><div class="ttdeci">if(!empty($image)) $post</div><div class="ttdef"><b>Definition:</b> <a href="actions_2post_2comment_8php_source.html#l00010">comment.php:10</a></div></div>
<div class="ttc" id="class_c_i___input_html_ad9ebdfce8f992b3a41aaf64ea8782933"><div class="ttname"><a href="class_c_i___input.html#ad9ebdfce8f992b3a41aaf64ea8782933">CI_Input\$_standardize_newlines</a></div><div class="ttdeci">$_standardize_newlines</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00055">Input.php:55</a></div></div>
<div class="ttc" id="class_c_i___input_html_a52500036ee807241b8b4b7e2367c49ef"><div class="ttname"><a href="class_c_i___input.html#a52500036ee807241b8b4b7e2367c49ef">CI_Input\$headers</a></div><div class="ttdeci">$headers</div><div class="ttdef"><b>Definition:</b> <a href="_input_8php_source.html#l00075">Input.php:75</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b3955658e6b3f08bfd2a3c26b5ae9ecb.html">ASN</a></li><li class="navelem"><a class="el" href="dir_eeca0cd5371b833b15dcc1fd8992e39f.html">vendors</a></li><li class="navelem"><a class="el" href="dir_efe56b061e058a0ff3882590159b47ce.html">tinymce</a></li><li class="navelem"><a class="el" href="dir_ae33a49e2952569561e32a55a104b71f.html">plugins</a></li><li class="navelem"><a class="el" href="dir_b57ed86969d37054e52ea6341dbf76cd.html">jbimages</a></li><li class="navelem"><a class="el" href="dir_4ad7fd180e14b0e923b5f96602db01c8.html">ci</a></li><li class="navelem"><a class="el" href="dir_826a0a7e2939202727d1717f091c4a5a.html">system</a></li><li class="navelem"><a class="el" href="dir_e7afe26c16aa98f38cef5885821eea3f.html">core</a></li><li class="navelem"><a class="el" href="_input_8php.html">Input.php</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
