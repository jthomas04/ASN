\hypertarget{class_c_i___security}{}\section{C\+I\+\_\+\+Security Class Reference}
\label{class_c_i___security}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_c_i___security_a095c5d389db211932136b53f25f39685}{\+\_\+\+\_\+construct} ()
\item 
\hyperlink{class_c_i___security_a03c037268db0c2e6221b65a736eaee07}{csrf\+\_\+verify} ()
\item 
\hyperlink{class_c_i___security_a55b1380b93b71ab3d9873bb967c2b9bb}{csrf\+\_\+set\+\_\+cookie} ()
\item 
\hyperlink{class_c_i___security_a3d09c1dc706abfaad987661805c28a06}{csrf\+\_\+show\+\_\+error} ()
\item 
\hyperlink{class_c_i___security_a1644fd8967db3a1b94988d730ca34991}{get\+\_\+csrf\+\_\+hash} ()
\item 
\hyperlink{class_c_i___security_a00640f51b90b7d946e9d3a4f0c9f628e}{get\+\_\+csrf\+\_\+token\+\_\+name} ()
\item 
\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean} (\$str, \$is\+\_\+image=F\+A\+L\+SE)
\item 
\hyperlink{class_c_i___security_ae2f831d3f277e1c03730b28fd1734186}{xss\+\_\+hash} ()
\item 
\hyperlink{class_c_i___security_aaba16489285496bdc03fd12f699a08f6}{sanitize\+\_\+filename} (\$str, \$relative\+\_\+path=F\+A\+L\+SE)
\item 
\hyperlink{class_c_i___security_a4adc45e6518de72122e8153f070e09b7}{entity\+\_\+decode} (\$str, \$charset= \textquotesingle{}U\+TF-\/8\textquotesingle{})
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_c_i___security_a7064dd5501c1dfab05ba6ac8838beb01}{\+\_\+csrf\+\_\+set\+\_\+hash} ()
\item 
\hyperlink{class_c_i___security_a31b2c9ae75f39b9b38fe05c494bb0f79}{\+\_\+validate\+\_\+entities} (\$str)
\item 
\hyperlink{class_c_i___security_a61217e43f888cdf8afb1fba16b5cd9f6}{\+\_\+do\+\_\+never\+\_\+allowed} (\$str)
\item 
\hyperlink{class_c_i___security_a37c160ddffea957e9eb03dbfd3471a78}{\+\_\+remove\+\_\+evil\+\_\+attributes} (\$str, \$is\+\_\+image)
\item 
\hyperlink{class_c_i___security_adfb0e251ae35ae40303a302d253c3ab2}{\+\_\+compact\+\_\+exploded\+\_\+words} (\$matches)
\item 
\hyperlink{class_c_i___security_af67689597607833df370031fb799c92b}{\+\_\+sanitize\+\_\+naughty\+\_\+html} (\$matches)
\item 
\hyperlink{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}{\+\_\+js\+\_\+link\+\_\+removal} (\$match)
\item 
\hyperlink{class_c_i___security_aa385a9c7527f5eece656b9cac73979d3}{\+\_\+filter\+\_\+attributes} (\$str)
\item 
\hyperlink{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}{\+\_\+js\+\_\+img\+\_\+removal} (\$match)
\item 
\hyperlink{class_c_i___security_ae16451bcdc769285c499cbf8068b3523}{\+\_\+convert\+\_\+attribute} (\$match)
\item 
\hyperlink{class_c_i___security_a5289832cb3ae9cee3c12e82ede958874}{\+\_\+decode\+\_\+entity} (\$match)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}{\$\+\_\+xss\+\_\+hash} = \textquotesingle{}\textquotesingle{}
\item 
\hyperlink{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}{\$\+\_\+csrf\+\_\+hash} = \textquotesingle{}\textquotesingle{}
\item 
\hyperlink{class_c_i___security_af86a83f20de2a3c522bf690d4080c08e}{\$\+\_\+csrf\+\_\+expire} = 7200
\item 
\hyperlink{class_c_i___security_a6752ebca4be235c079785a87a693d932}{\$\+\_\+csrf\+\_\+token\+\_\+name} = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}
\item 
\hyperlink{class_c_i___security_a52043f2c9ffb0e14eade8e67a0172a82}{\$\+\_\+csrf\+\_\+cookie\+\_\+name} = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}
\item 
\hyperlink{class_c_i___security_ab883fab930a1c4a926eaa501ab211823}{\$\+\_\+never\+\_\+allowed\+\_\+str}
\item 
\hyperlink{class_c_i___security_ac502ee17d09eb8bbd70a6fb1f9515503}{\$\+\_\+never\+\_\+allowed\+\_\+regex}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 28 of file Security.\+php.



\subsection{Constructor \& Destructor Documentation}
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+\+\_\+construct@{\+\_\+\+\_\+construct}}
\index{\+\_\+\+\_\+construct@{\+\_\+\+\_\+construct}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+\+\_\+construct()}{__construct()}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+\+\_\+construct (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_c_i___security_a095c5d389db211932136b53f25f39685}{}\label{class_c_i___security_a095c5d389db211932136b53f25f39685}
Constructor

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 107 of file Security.\+php.



\subsection{Member Function Documentation}
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+compact\+\_\+exploded\+\_\+words@{\+\_\+compact\+\_\+exploded\+\_\+words}}
\index{\+\_\+compact\+\_\+exploded\+\_\+words@{\+\_\+compact\+\_\+exploded\+\_\+words}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+compact\+\_\+exploded\+\_\+words(\$matches)}{_compact_exploded_words($matches)}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+compact\+\_\+exploded\+\_\+words (
\begin{DoxyParamCaption}
\item[{}]{\$matches}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_adfb0e251ae35ae40303a302d253c3ab2}{}\label{class_c_i___security_adfb0e251ae35ae40303a302d253c3ab2}
Compact Exploded Words

Callback function for \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()} to remove whitespace from things like j a v a s c r i p t


\begin{DoxyParams}{Parameters}
{\em type} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
type 
\end{DoxyReturn}


Definition at line 724 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+convert\+\_\+attribute@{\+\_\+convert\+\_\+attribute}}
\index{\+\_\+convert\+\_\+attribute@{\+\_\+convert\+\_\+attribute}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+convert\+\_\+attribute(\$match)}{_convert_attribute($match)}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+convert\+\_\+attribute (
\begin{DoxyParamCaption}
\item[{}]{\$match}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_ae16451bcdc769285c499cbf8068b3523}{}\label{class_c_i___security_ae16451bcdc769285c499cbf8068b3523}
Attribute Conversion

Used as a callback for X\+SS Clean


\begin{DoxyParams}{Parameters}
{\em array} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 826 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+csrf\+\_\+set\+\_\+hash@{\+\_\+csrf\+\_\+set\+\_\+hash}}
\index{\+\_\+csrf\+\_\+set\+\_\+hash@{\+\_\+csrf\+\_\+set\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+csrf\+\_\+set\+\_\+hash()}{_csrf_set_hash()}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+csrf\+\_\+set\+\_\+hash (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_a7064dd5501c1dfab05ba6ac8838beb01}{}\label{class_c_i___security_a7064dd5501c1dfab05ba6ac8838beb01}
Set Cross Site Request Forgery Protection Cookie

\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 140 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+decode\+\_\+entity@{\+\_\+decode\+\_\+entity}}
\index{\+\_\+decode\+\_\+entity@{\+\_\+decode\+\_\+entity}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+decode\+\_\+entity(\$match)}{_decode_entity($match)}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+decode\+\_\+entity (
\begin{DoxyParamCaption}
\item[{}]{\$match}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_a5289832cb3ae9cee3c12e82ede958874}{}\label{class_c_i___security_a5289832cb3ae9cee3c12e82ede958874}
H\+T\+ML Entity Decode Callback

Used as a callback for X\+SS Clean


\begin{DoxyParams}{Parameters}
{\em array} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 848 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+do\+\_\+never\+\_\+allowed@{\+\_\+do\+\_\+never\+\_\+allowed}}
\index{\+\_\+do\+\_\+never\+\_\+allowed@{\+\_\+do\+\_\+never\+\_\+allowed}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+do\+\_\+never\+\_\+allowed(\$str)}{_do_never_allowed($str)}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+do\+\_\+never\+\_\+allowed (
\begin{DoxyParamCaption}
\item[{}]{\$str}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_a61217e43f888cdf8afb1fba16b5cd9f6}{}\label{class_c_i___security_a61217e43f888cdf8afb1fba16b5cd9f6}
Do Never Allowed

A utility function for \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()}


\begin{DoxyParams}{Parameters}
{\em string} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 574 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+filter\+\_\+attributes@{\+\_\+filter\+\_\+attributes}}
\index{\+\_\+filter\+\_\+attributes@{\+\_\+filter\+\_\+attributes}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+filter\+\_\+attributes(\$str)}{_filter_attributes($str)}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+filter\+\_\+attributes (
\begin{DoxyParamCaption}
\item[{}]{\$str}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_aa385a9c7527f5eece656b9cac73979d3}{}\label{class_c_i___security_aa385a9c7527f5eece656b9cac73979d3}
Filter Attributes

Filters tag attributes for consistency and safety


\begin{DoxyParams}{Parameters}
{\em string} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 784 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+js\+\_\+img\+\_\+removal@{\+\_\+js\+\_\+img\+\_\+removal}}
\index{\+\_\+js\+\_\+img\+\_\+removal@{\+\_\+js\+\_\+img\+\_\+removal}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+js\+\_\+img\+\_\+removal(\$match)}{_js_img_removal($match)}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+js\+\_\+img\+\_\+removal (
\begin{DoxyParamCaption}
\item[{}]{\$match}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}{}\label{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}
JS Image Removal

Callback function for \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()} to sanitize image tags This limits the P\+C\+RE backtracks, making it more performance friendly and prevents P\+R\+E\+G\+\_\+\+B\+A\+C\+K\+T\+R\+A\+C\+K\+\_\+\+L\+I\+M\+I\+T\+\_\+\+E\+R\+R\+OR from being triggered in P\+HP 5.\+2+ on image tag heavy strings


\begin{DoxyParams}{Parameters}
{\em array} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 809 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+js\+\_\+link\+\_\+removal@{\+\_\+js\+\_\+link\+\_\+removal}}
\index{\+\_\+js\+\_\+link\+\_\+removal@{\+\_\+js\+\_\+link\+\_\+removal}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+js\+\_\+link\+\_\+removal(\$match)}{_js_link_removal($match)}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+js\+\_\+link\+\_\+removal (
\begin{DoxyParamCaption}
\item[{}]{\$match}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}{}\label{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}
JS Link Removal

Callback function for \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()} to sanitize links This limits the P\+C\+RE backtracks, making it more performance friendly and prevents P\+R\+E\+G\+\_\+\+B\+A\+C\+K\+T\+R\+A\+C\+K\+\_\+\+L\+I\+M\+I\+T\+\_\+\+E\+R\+R\+OR from being triggered in P\+HP 5.\+2+ on link-\/heavy strings


\begin{DoxyParams}{Parameters}
{\em array} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 767 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+remove\+\_\+evil\+\_\+attributes@{\+\_\+remove\+\_\+evil\+\_\+attributes}}
\index{\+\_\+remove\+\_\+evil\+\_\+attributes@{\+\_\+remove\+\_\+evil\+\_\+attributes}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+remove\+\_\+evil\+\_\+attributes(\$str, \$is\+\_\+image)}{_remove_evil_attributes($str, $is_image)}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+remove\+\_\+evil\+\_\+attributes (
\begin{DoxyParamCaption}
\item[{}]{\$str, }
\item[{}]{\$is\+\_\+image}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_a37c160ddffea957e9eb03dbfd3471a78}{}\label{class_c_i___security_a37c160ddffea957e9eb03dbfd3471a78}


Definition at line 602 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+sanitize\+\_\+naughty\+\_\+html@{\+\_\+sanitize\+\_\+naughty\+\_\+html}}
\index{\+\_\+sanitize\+\_\+naughty\+\_\+html@{\+\_\+sanitize\+\_\+naughty\+\_\+html}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+sanitize\+\_\+naughty\+\_\+html(\$matches)}{_sanitize_naughty_html($matches)}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+sanitize\+\_\+naughty\+\_\+html (
\begin{DoxyParamCaption}
\item[{}]{\$matches}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_af67689597607833df370031fb799c92b}{}\label{class_c_i___security_af67689597607833df370031fb799c92b}
Sanitize Naughty H\+T\+ML

Callback function for \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()} to remove naughty H\+T\+ML elements


\begin{DoxyParams}{Parameters}
{\em array} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 738 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+validate\+\_\+entities@{\+\_\+validate\+\_\+entities}}
\index{\+\_\+validate\+\_\+entities@{\+\_\+validate\+\_\+entities}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\+\_\+validate\+\_\+entities(\$str)}{_validate_entities($str)}}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+validate\+\_\+entities (
\begin{DoxyParamCaption}
\item[{}]{\$str}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_a31b2c9ae75f39b9b38fe05c494bb0f79}{}\label{class_c_i___security_a31b2c9ae75f39b9b38fe05c494bb0f79}
Validate U\+RL entities

Called by \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()}


\begin{DoxyParams}{Parameters}
{\em string} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 514 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!csrf\+\_\+set\+\_\+cookie@{csrf\+\_\+set\+\_\+cookie}}
\index{csrf\+\_\+set\+\_\+cookie@{csrf\+\_\+set\+\_\+cookie}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{csrf\+\_\+set\+\_\+cookie()}{csrf_set_cookie()}}]{\setlength{\rightskip}{0pt plus 5cm}csrf\+\_\+set\+\_\+cookie (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_c_i___security_a55b1380b93b71ab3d9873bb967c2b9bb}{}\label{class_c_i___security_a55b1380b93b71ab3d9873bb967c2b9bb}
Set Cross Site Request Forgery Protection Cookie

\begin{DoxyReturn}{Returns}
object 
\end{DoxyReturn}


Definition at line 201 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!csrf\+\_\+show\+\_\+error@{csrf\+\_\+show\+\_\+error}}
\index{csrf\+\_\+show\+\_\+error@{csrf\+\_\+show\+\_\+error}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{csrf\+\_\+show\+\_\+error()}{csrf_show_error()}}]{\setlength{\rightskip}{0pt plus 5cm}csrf\+\_\+show\+\_\+error (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_c_i___security_a3d09c1dc706abfaad987661805c28a06}{}\label{class_c_i___security_a3d09c1dc706abfaad987661805c28a06}
Show C\+S\+RF Error

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 223 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!csrf\+\_\+verify@{csrf\+\_\+verify}}
\index{csrf\+\_\+verify@{csrf\+\_\+verify}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{csrf\+\_\+verify()}{csrf_verify()}}]{\setlength{\rightskip}{0pt plus 5cm}csrf\+\_\+verify (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_c_i___security_a03c037268db0c2e6221b65a736eaee07}{}\label{class_c_i___security_a03c037268db0c2e6221b65a736eaee07}
Verify Cross Site Request Forgery Protection

\begin{DoxyReturn}{Returns}
object 
\end{DoxyReturn}


Definition at line 164 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!entity\+\_\+decode@{entity\+\_\+decode}}
\index{entity\+\_\+decode@{entity\+\_\+decode}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{entity\+\_\+decode(\$str, \$charset= \textquotesingle{}\+U\+T\+F-\/8\textquotesingle{})}{entity_decode($str, $charset= 'UTF-8')}}]{\setlength{\rightskip}{0pt plus 5cm}entity\+\_\+decode (
\begin{DoxyParamCaption}
\item[{}]{\$str, }
\item[{}]{\$charset = {\ttfamily \textquotesingle{}UTF-\/8\textquotesingle{}}}
\end{DoxyParamCaption}
)}\hypertarget{class_c_i___security_a4adc45e6518de72122e8153f070e09b7}{}\label{class_c_i___security_a4adc45e6518de72122e8153f070e09b7}
H\+T\+ML Entities Decode

This function is a replacement for html\+\_\+entity\+\_\+decode()

The reason we are not using html\+\_\+entity\+\_\+decode() by itself is because while it is not technically correct to leave out the semicolon at the end of an entity most browsers will still interpret the entity correctly. html\+\_\+entity\+\_\+decode() does not convert entities without semicolons, so we are left with our own little solution here. Bummer.


\begin{DoxyParams}{Parameters}
{\em string} & \\
\hline
{\em string} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 869 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!get\+\_\+csrf\+\_\+hash@{get\+\_\+csrf\+\_\+hash}}
\index{get\+\_\+csrf\+\_\+hash@{get\+\_\+csrf\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{get\+\_\+csrf\+\_\+hash()}{get_csrf_hash()}}]{\setlength{\rightskip}{0pt plus 5cm}get\+\_\+csrf\+\_\+hash (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_c_i___security_a1644fd8967db3a1b94988d730ca34991}{}\label{class_c_i___security_a1644fd8967db3a1b94988d730ca34991}
Get C\+S\+RF Hash

Getter Method

\begin{DoxyReturn}{Returns}
string self\+::\+\_\+csrf\+\_\+hash 
\end{DoxyReturn}


Definition at line 236 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!get\+\_\+csrf\+\_\+token\+\_\+name@{get\+\_\+csrf\+\_\+token\+\_\+name}}
\index{get\+\_\+csrf\+\_\+token\+\_\+name@{get\+\_\+csrf\+\_\+token\+\_\+name}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{get\+\_\+csrf\+\_\+token\+\_\+name()}{get_csrf_token_name()}}]{\setlength{\rightskip}{0pt plus 5cm}get\+\_\+csrf\+\_\+token\+\_\+name (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_c_i___security_a00640f51b90b7d946e9d3a4f0c9f628e}{}\label{class_c_i___security_a00640f51b90b7d946e9d3a4f0c9f628e}
Get C\+S\+RF Token Name

Getter Method

\begin{DoxyReturn}{Returns}
string self\+::csrf\+\_\+token\+\_\+name 
\end{DoxyReturn}


Definition at line 249 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!sanitize\+\_\+filename@{sanitize\+\_\+filename}}
\index{sanitize\+\_\+filename@{sanitize\+\_\+filename}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{sanitize\+\_\+filename(\$str, \$relative\+\_\+path=\+F\+A\+L\+S\+E)}{sanitize_filename($str, $relative_path=FALSE)}}]{\setlength{\rightskip}{0pt plus 5cm}sanitize\+\_\+filename (
\begin{DoxyParamCaption}
\item[{}]{\$str, }
\item[{}]{\$relative\+\_\+path = {\ttfamily FALSE}}
\end{DoxyParamCaption}
)}\hypertarget{class_c_i___security_aaba16489285496bdc03fd12f699a08f6}{}\label{class_c_i___security_aaba16489285496bdc03fd12f699a08f6}
Filename Security


\begin{DoxyParams}{Parameters}
{\em string} & \\
\hline
{\em bool} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 657 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!xss\+\_\+clean@{xss\+\_\+clean}}
\index{xss\+\_\+clean@{xss\+\_\+clean}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{xss\+\_\+clean(\$str, \$is\+\_\+image=\+F\+A\+L\+S\+E)}{xss_clean($str, $is_image=FALSE)}}]{\setlength{\rightskip}{0pt plus 5cm}xss\+\_\+clean (
\begin{DoxyParamCaption}
\item[{}]{\$str, }
\item[{}]{\$is\+\_\+image = {\ttfamily FALSE}}
\end{DoxyParamCaption}
)}\hypertarget{class_c_i___security_acb759426dbab128d3d8164805225381c}{}\label{class_c_i___security_acb759426dbab128d3d8164805225381c}
X\+SS Clean

Sanitizes data so that Cross Site Scripting Hacks can be prevented. This function does a fair amount of work but it is extremely thorough, designed to prevent even the most obscure X\+SS attempts. Nothing is ever 100\% foolproof, of course, but I haven\textquotesingle{}t been able to get anything passed the filter.

Note\+: This function should only be used to deal with data upon submission. It\textquotesingle{}s not something that should be used for general runtime processing.

This function was based in part on some code and ideas I got from Bitflux\+: \href{http://channel.bitflux.ch/wiki/XSS_Prevention}{\tt http\+://channel.\+bitflux.\+ch/wiki/\+X\+S\+S\+\_\+\+Prevention}

To help develop this script I used this great list of vulnerabilities along with a few other hacks I\textquotesingle{}ve harvested from examining vulnerabilities in other programs\+: \href{http://ha.ckers.org/xss.html}{\tt http\+://ha.\+ckers.\+org/xss.\+html}


\begin{DoxyParams}{Parameters}
{\em mixed} & string or array \\
\hline
{\em bool} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 281 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!xss\+\_\+hash@{xss\+\_\+hash}}
\index{xss\+\_\+hash@{xss\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{xss\+\_\+hash()}{xss_hash()}}]{\setlength{\rightskip}{0pt plus 5cm}xss\+\_\+hash (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_c_i___security_ae2f831d3f277e1c03730b28fd1734186}{}\label{class_c_i___security_ae2f831d3f277e1c03730b28fd1734186}
Random Hash for protecting U\+R\+Ls

\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Definition at line 555 of file Security.\+php.



\subsection{Field Documentation}
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+cookie\+\_\+name@{\$\+\_\+csrf\+\_\+cookie\+\_\+name}}
\index{\$\+\_\+csrf\+\_\+cookie\+\_\+name@{\$\+\_\+csrf\+\_\+cookie\+\_\+name}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\$\+\_\+csrf\+\_\+cookie\+\_\+name}{$_csrf_cookie_name}}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+csrf\+\_\+cookie\+\_\+name = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_a52043f2c9ffb0e14eade8e67a0172a82}{}\label{class_c_i___security_a52043f2c9ffb0e14eade8e67a0172a82}


Definition at line 65 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+expire@{\$\+\_\+csrf\+\_\+expire}}
\index{\$\+\_\+csrf\+\_\+expire@{\$\+\_\+csrf\+\_\+expire}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\$\+\_\+csrf\+\_\+expire}{$_csrf_expire}}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+csrf\+\_\+expire = 7200\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_af86a83f20de2a3c522bf690d4080c08e}{}\label{class_c_i___security_af86a83f20de2a3c522bf690d4080c08e}


Definition at line 51 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+hash@{\$\+\_\+csrf\+\_\+hash}}
\index{\$\+\_\+csrf\+\_\+hash@{\$\+\_\+csrf\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\$\+\_\+csrf\+\_\+hash}{$_csrf_hash}}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+csrf\+\_\+hash = \textquotesingle{}\textquotesingle{}\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}{}\label{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}


Definition at line 43 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+token\+\_\+name@{\$\+\_\+csrf\+\_\+token\+\_\+name}}
\index{\$\+\_\+csrf\+\_\+token\+\_\+name@{\$\+\_\+csrf\+\_\+token\+\_\+name}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\$\+\_\+csrf\+\_\+token\+\_\+name}{$_csrf_token_name}}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+csrf\+\_\+token\+\_\+name = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_a6752ebca4be235c079785a87a693d932}{}\label{class_c_i___security_a6752ebca4be235c079785a87a693d932}


Definition at line 58 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+never\+\_\+allowed\+\_\+regex@{\$\+\_\+never\+\_\+allowed\+\_\+regex}}
\index{\$\+\_\+never\+\_\+allowed\+\_\+regex@{\$\+\_\+never\+\_\+allowed\+\_\+regex}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\$\+\_\+never\+\_\+allowed\+\_\+regex}{$_never_allowed_regex}}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+never\+\_\+allowed\+\_\+regex\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_ac502ee17d09eb8bbd70a6fb1f9515503}{}\label{class_c_i___security_ac502ee17d09eb8bbd70a6fb1f9515503}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= array(
        \textcolor{stringliteral}{'javascript\(\backslash\)s*:'},
        \textcolor{stringliteral}{'expression\(\backslash\)s*(\(\backslash\)(|&\(\backslash\)#40;)'},
        
        \textcolor{stringliteral}{'vbscript\(\backslash\)s*:'},
        
        \textcolor{stringliteral}{'Redirect\(\backslash\)s+302'},
        \textcolor{stringliteral}{"([\(\backslash\)"'])?data\(\backslash\)s*:[^\(\backslash\)\(\backslash\)1]*?base64[^\(\backslash\)\(\backslash\)1]*?,[^\(\backslash\)\(\backslash\)1]*?\(\backslash\)\(\backslash\)1?"}
    )
\end{DoxyCode}


Definition at line 92 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+never\+\_\+allowed\+\_\+str@{\$\+\_\+never\+\_\+allowed\+\_\+str}}
\index{\$\+\_\+never\+\_\+allowed\+\_\+str@{\$\+\_\+never\+\_\+allowed\+\_\+str}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\$\+\_\+never\+\_\+allowed\+\_\+str}{$_never_allowed_str}}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+never\+\_\+allowed\+\_\+str\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_ab883fab930a1c4a926eaa501ab211823}{}\label{class_c_i___security_ab883fab930a1c4a926eaa501ab211823}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= array(
        \textcolor{stringliteral}{'document.cookie'} => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'document.write'} => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'.parentNode'} => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'.innerHTML'} => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'window.location'} => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'-moz-binding'} => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'<!--'} => \textcolor{stringliteral}{'&lt;!--'},
        \textcolor{stringliteral}{'-->'} => \textcolor{stringliteral}{'--&gt;'},
        \textcolor{stringliteral}{'<![CDATA['} => \textcolor{stringliteral}{'&lt;![CDATA['},
        \textcolor{stringliteral}{'<comment>'} => \textcolor{stringliteral}{'&lt;comment&gt;'}
    )
\end{DoxyCode}


Definition at line 72 of file Security.\+php.

\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+xss\+\_\+hash@{\$\+\_\+xss\+\_\+hash}}
\index{\$\+\_\+xss\+\_\+hash@{\$\+\_\+xss\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\texorpdfstring{\$\+\_\+xss\+\_\+hash}{$_xss_hash}}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+xss\+\_\+hash = \textquotesingle{}\textquotesingle{}\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}{}\label{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}


Definition at line 36 of file Security.\+php.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/jj/\+Projects/\+A\+S\+N/vendors/tinymce/plugins/jbimages/ci/system/core/\hyperlink{_security_8php}{Security.\+php}\end{DoxyCompactItemize}
